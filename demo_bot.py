import os
from demo_chart import generate_demo_chart

# Demo —Ñ—É–Ω–∫—Ü—É—É–¥ - –∂–∏–Ω—Ö—ç–Ω—ç API keys-–≥“Ø–π–≥—ç—ç—Ä –∞–∂–∏–ª–ª–∞—Ö
def demo_analyze_chart(prompt, image_path):
    """Demo GPT —à–∏–Ω–∂–∏–ª–≥—ç—ç - –∂–∏–Ω—Ö—ç–Ω—ç OpenAI API-–≥“Ø–π–≥—ç—ç—Ä"""
    
    demo_response = """
üîç **–¢–ï–•–ù–ò–ö–ò–ô–ù –®–ò–ù–ñ–ò–õ–ì–≠–≠ - XAUUSD**

üìä **–ê–†–ò–õ–ñ–ê–ê–ù–´ –®–ò–ô–î–í–≠–†: –•–£–î–ê–õ–î–ê–• (SELL)**

üí∞ **–û–†–û–õ–¢–´–ù –ü–ê–†–ê–ú–ï–¢–†–£–£–î:**
- –û—Ä–æ–ª—Ç—ã–Ω “Ø–Ω—ç: 2,010.50 USD
- Stop Loss (SL): 2,025.00 USD  
- Take Profit (TP): 1,985.00 USD

üîç **–¢–ï–•–ù–ò–ö–ò–ô–ù “Æ–ù–î–≠–°–õ–≠–õ:**
- –•“Ø—á—Ç—ç–π resistance –∑“Ø—Ä—ç–Ω –¥—ç—ç—Ä —Ç–∞—Ç–∞–∂ –±—É–π –±–∞–π–¥–∞–ª
- Bearish engulfing –Ω”©—Ö—Ü”©–ª “Ø“Ø—Å—á –±–∞–π–Ω–∞
- RSI —Ö—ç—Ç —Ö—É–¥–∞–ª–¥–∞–Ω –∞–≤–∞–≥–¥—Å–∞–Ω (overbought) –±“Ø—Å—ç–¥ –æ—Ä–∂ –±–∞–π–Ω–∞
- 50 MA-–∏–π–Ω –¥–∞–≥—É—É support —Å—É–ª–∞–ª—Ç —Ö–∞—Ä–∞–≥–¥–∞–∂ –±–∞–π–Ω–∞

‚ö†Ô∏è **–≠–†–°–î–≠–õ–ò–ô–ù –£–î–ò–†–î–õ–ê–ì–ê:**
- Position size: 0.1 lot-–∞–∞—Å –∏—Ö–≥“Ø–π
- Risk/Reward ratio: 1:1.8

ü§ñ AI-–∏–π–Ω –¥“Ø–≥–Ω—ç–ª—Ç: –ë–æ–≥–∏–Ω–æ —Ö—É–≥–∞—Ü–∞–∞–Ω–¥ –¥–æ–æ—à–ª–æ—Ö —Ö–∞–Ω–¥–ª–∞–≥–∞ –¥—ç—ç–¥—ç–ª–∂ –±–∞–π–Ω–∞.
"""
    return demo_response

def demo_send_telegram(message):
    """Demo Telegram –º–µ—Å—Å–µ–∂ –∏–ª–≥—ç—ç—Ö"""
    print("üì± TELEGRAM –ú–ï–°–°–ï–ñ:")
    print("=" * 50)
    print(message)
    print("=" * 50)
    print("‚úÖ Demo Telegram –º–µ—Å—Å–µ–∂ '–∏–ª–≥—ç—ç–≥–¥–ª—ç—ç'")

def demo_check_news(symbol):
    """Demo —ç–¥–∏–π–Ω –∑–∞—Å–≥–∏–π–Ω –º—ç–¥—ç—ç —à–∞–ª–≥–∞—Ö"""
    import random
    return random.choice([True, False])  # –°–∞–Ω–∞–º—Å–∞—Ä–≥“Ø–π “Ø—Ä –¥“Ø–Ω

def run_demo_bot():
    """Demo bot –∞–∂–∏–ª–ª—É—É–ª–∞—Ö"""
    print("ü§ñ AIVO TRADING BOT - DEMO MODE")
    print("=" * 50)
    
    symbol = "XAUUSD"
    timeframe = "15m"
    
    print("üìä –ì—Ä–∞—Ñ–∏–∫ –∑—É—Ä–∂ –±–∞–π–Ω–∞...")
    image_file = generate_demo_chart(symbol, timeframe)
    
    print("üì∞ –≠–¥–∏–π–Ω –∑–∞—Å–≥–∏–π–Ω –º—ç–¥—ç—ç —à–∞–ª–≥–∞–∂ –±–∞–π–Ω–∞...")
    if demo_check_news(symbol):
        print("‚ö†Ô∏è ”®–Ω–¥”©—Ä –Ω”©–ª”©”©—Ç—ç–π —ç–¥–∏–π–Ω –∑–∞—Å–≥–∏–π–Ω –º—ç–¥—ç—ç –±–∞–π–Ω–∞. –ê—Ä–∏–ª–∂–∞–∞ —Ö–∏–π—Ö–≥“Ø–π.")
        return
    else:
        print("‚úÖ –ù”©–ª”©”© ”©–Ω–¥”©—Ä—Ç—ç–π –º—ç–¥—ç—ç –∏–ª—Ä—ç—ç–≥“Ø–π.")
    
    print("üß† GPT —à–∏–π–¥–≤—ç—Ä –∞–≤—á –±–∞–π–Ω–∞...")
    try:
        prompt = f"""
–¢–∞ –±–æ–ª –º—ç—Ä–≥—ç—à—Å—ç–Ω —Ñ–æ—Ä–µ–∫—Å —à–∏–Ω–∂—ç—ç—á.
–≠–Ω—ç –≥—Ä–∞—Ñ–∏–∫–∏–π–≥ —à–∏–Ω–∂–ª—ç—ç–¥ –¥–∞—Ä–∞–∞—Ö “Ø–Ω–¥—Å—ç–Ω —á–∏–≥–ª—ç–ª, —Ç”©–≤—à–∏–Ω–≥“Ø“Ø–¥–∏–π–≥ —Å–∞–Ω–∞–ª –±–æ–ª–≥–æ–Ω–æ —É—É:

- –ê—Ä–∏–ª–∂–∞–∞–Ω—ã —à–∏–π–¥–≤—ç—Ä (–•–£–î–ê–õ–î–ê–ñ –ê–í–ê–•, –•–£–î–ê–õ–î–ê–• —ç—Å–≤—ç–ª –•“Æ–õ–≠–≠–•)
- –û—Ä–æ–ª—Ç—ã–Ω “Ø–Ω—ç, Stop Loss (SL), Take Profit (TP)
- –¢–µ—Ö–Ω–∏–∫–∏–π–Ω —Ç–∞–π–ª–±–∞—Ä (support/resistance, liquidity zones, order blocks, candlestick patterns)

–•–æ—Å–ª–æ–ª: {symbol}, –¶–∞–≥–∏–π–Ω —Ö“Ø—Ä—ç—ç: {timeframe}
"""
        print("üß† GPT Vision API –∞–∂–∏–ª–ª–∞–∂ –±–∞–π–Ω–∞... (DEMO)")
        gpt_response = demo_analyze_chart(prompt.strip(), image_file)
        print("üì© GPT —Ö–∞—Ä–∏—É –∞–º–∂–∏–ª—Ç—Ç–∞–π –∏—Ä–ª—ç—ç.")
        
        telegram_message = f"""üìà **–ê–†–ò–õ–ñ–ê–ê–ù–´ –®–ò–ô–î–í–≠–† - DEMO**
üìå –•–æ—Å–ª–æ–ª: {symbol}
‚è± –¶–∞–≥–∏–π–Ω —Ö“Ø—Ä—ç—ç: {timeframe}

{gpt_response}

ü§ñ AI-–∏–π–Ω —à–∏–Ω–∂–∏–ª–≥—ç—ç–≥ “Ø–Ω–¥—ç—Å–ª—ç–Ω –±–æ–ª–æ–≤—Å—Ä—É—É–ª–∞–≤.
üìä –ì—Ä–∞—Ñ–∏–∫ –∑—É—Ä–∞–≥: {image_file}

‚ö†Ô∏è –ê–ù–•–ê–ê–†–£–£–õ–ì–ê: –≠–Ω—ç –±–æ–ª DEMO –≥–æ—Ä–∏–º —é–º. –ñ–∏–Ω—Ö—ç–Ω—ç –∞—Ä–∏–ª–∂–∞–∞–Ω–¥ –∞—à–∏–≥–ª–∞—Ö–≥“Ø–π –±–∞–π—Ö!"""
        
        demo_send_telegram(telegram_message)
        
        print("‚úÖ Demo –ø—Ä–æ—Ü–µ—Å—Å –¥—É—É—Å–ª–∞–∞.")
        print(f"üìä –ì—Ä–∞—Ñ–∏–∫ —Ñ–∞–π–ª: {image_file}")
        
    except Exception as e:
        print(f"‚ùå Demo error: {e}")

if __name__ == "__main__":
    run_demo_bot()